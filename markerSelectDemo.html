<!DOCTYPE html>
<html>
	<head>
		<title>Google Maps Marker Select Demo</title>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
		<script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript" language="javascript"></script>
		<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/tags/keydragzoom/2.0.5/src/keydragzoom.js"></script>
		<script type="text/javascript" src="https://raw.github.com/tparkin/Google-Maps-Point-in-Polygon/master/maps.google.polygon.containsLatLng.js"></script>
		
		<script type="text/javascript" src="SMap.js"></script>
		
		<script type="text/javascript">
			
			var selmap;
			
			$(function() {
				initMap();
			});
			
			function initMap()
			{
				selmap = new SMap.markerSelectMap('map');
				var point1 = new google.maps.LatLng(41.404374,-81.663493);
				var point2 = new google.maps.LatLng(41.40189,-81.663716);
				google.maps.Marker.prototype.windowContent = '<a href="#">Testing</a> <br /> <div>Here is some text.</div>';
				var marker1 = new google.maps.Marker({
					position: point1
				});
				var marker2 = new google.maps.Marker({
					position: point2
				});
				var marker3 = new google.maps.Marker({
					position: new google.maps.LatLng(41.402720,-81.663269),
					icon: 'http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png'
				});
				var infowindow = new google.maps.InfoWindow({
					content: marker1.windowContent
				});
				google.maps.event.addListener(marker1,'click',function(){
					infowindow.open(selmap.map,marker1);
				});
				mapmarkers = [marker1, marker2];
				mapmarkers2 = [marker3];
				
				selmap.addMarkerGroup('red',mapmarkers);
				selmap.addMarkerGroup('blue',mapmarkers2);
				
				selmap.addBoxListener('dragstart',updateLabels);
				selmap.addBoxListener('drag',updateLabels);
				selmap.addBoxListener('dragend',updateLabels);
						
				selmap.addPolygonListener('addpoint',updateLabels);
				selmap.addPolygonListener('removepoint',updateLabels);
				selmap.addPolygonListener('dragpoint',updateLabels);
				
				
			  	var myStyles =[
				    {
				        featureType: "poi",
				        elementType: "labels",
				        stylers: [
				              { visibility: "off" }
				        ]
				    }
				];
				selmap.map.setOptions({
					styles: myStyles
				});
			}
			
		</script>
		
		<script type="text/javascript">
			
			$(function() {
				$("#toolButtonContainer input[type=button]").click(function() {
					$("#toolButtonContainer input[type=button]").removeClass('selected');
					$(this).addClass('selected');
					if ($(this).prop('value') == 'Hand')
						selmap.setTool(SMap.Tools.HAND);
					else if ($(this).prop('value') == 'Box') {
						selmap.setTool(SMap.Tools.BOX);
					}
					else if ($(this).prop('value') == 'Polygon') {
						selmap.setTool(SMap.Tools.POLYGON);
						selmap.setPolygonOptions({fillColor: 'green'});
					}
					updateLabels();
				});
				
				$('#clear').click(function() {
					selmap.clearOverlays();
					updateLabels();
				});
			});
			
			function updateLabels() {
				var selMarkerGroup = selmap.getSelectedGroupMarkers(['red','blue']);
				$('#numpoints').html( selMarkerGroup['red'].length + selMarkerGroup['blue'].length );
				$('#g1points').html(selMarkerGroup['red'].length);
				$('#g2points').html(selMarkerGroup['blue'].length);
			}
			
		</script>
		
		<style type="text/css">
			
			#toolButtonContainer input, #toolButtonContainer a
			{
				margin: 0 10px;
			}
			
			#toolButtonContainer a
			{
				color: blue;
			}
			
			#toolButtonContainer input.selected
			{
				border-style: inset;
			}
			
		</style>
		
	</head>
	<body>
		<div style="width: 970px; margin: auto;">
			<div style="height: 600px;" id="map"></div>
		</div>
		<div style="text-align:center; margin: 20px auto;" id="toolButtonContainer">
			<input type="button" value="Hand" class="selected" />
			<input type="button" value="Box" class="" />
			<input type="button" value="Polygon" class="" />
			<a href="#" id="clear">Clear Map</a>
		</div>
		<div style="text-align:center;">
			<label for="numpoints">Number of Markers Selected: </label>
			<span id="numpoints">0</span>
		</div>
		<div style="text-align:center;">
			<label for="g1points">Number of Red Points</label>
			<span id="g1points">0</span>
		</div>
		<div style="text-align:center;">
			<label for="g2points">Number of Blue Points</label>
			<span id="g2points">0</span>
		</div>
	</body>
</html>